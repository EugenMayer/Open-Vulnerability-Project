# nvd-lib

A simple client for the NVD API. Currently, only the Vulnerabilities API is implemented; if the Products API is desired
please open an issue or create a PR.

## NVD Links
* [Getting Started](https://nvd.nist.gov/developers/start-here)
* [Vulnerabilities API](https://nvd.nist.gov/developers/vulnerabilities)
* [Request an NVD API Key](https://nvd.nist.gov/developers/request-an-api-key)

## Usage

Currently, the library is in development and has not been published in Maven Central. As such, the library can be built
using:

```shell
./gradlew clean build
```

The API is intended to be fairly simple; an example implementation is given below to retrieve the entire NVD CVE data
set - including a mechanism to keep the data up to date.

```java
import dev.jeremylong.nvdlib.NvdCveApi;
import dev.jeremylong.nvdlib.NvdCveApiBuilder;
import dev.jeremylong.nvdlib.nvd.DefCveItem;

import java.time.LocalDateTime;
import java.time.ZoneOffset;
import java.util.Collection;

public class Example {

    long retrieveLastModifiedRequestEpoch() {
        //TODO implement a storage/retrieval mechanism for the epoch time.
        // if the last modified request epoch is not avaiable the method should return 0
        return 0;
    }

    void storeLastModifiedRequestEpoch(long epoch) {
        //TODO implement a storage/retrieval mechanism for the epoch time.
    }

    public void update() {
        long lastModifiedRequest = retrieveLastModifiedRequestEpoch();
        NvdCveApiBuilder builder = NvdCveApiBuilder.aNvdCveApi();
        if (lastModifiedRequest > 0) {
            LocalDateTime start = LocalDateTime.ofEpochSecond(lastModifiedRequest, 0, ZoneOffset.UTC);
            LocalDateTime end = start.minusDays(-120);
            builder.withLastModifiedFilter(start, end);
        }
        //TODO add API key with builder's `withApiKey()`
        //TODO add delay with builder's `withDelay()` - **very important if an API key is not used**
        //TODO add any additional filters via the builder's `withfilter()`
        try (NvdCveApi api = builder.build()) {
            while (api.hasNext()) {
                Collection<DefCveItem> items = api.next();
                //TODO do something with the items
            }
            lastModifiedRequest = api.getLastModifiedRequest();
        } catch (Exception e) {
            e.printStackTrace();
        }
        storeLastModifiedRequestEpoch(lastModifiedRequest);
    }
}
```
