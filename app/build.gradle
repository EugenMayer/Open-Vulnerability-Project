plugins {
	id 'nvd.tools.java-application-conventions'
	id 'org.springframework.boot' version '2.7.5'
	id 'io.spring.dependency-management' version '1.0.15.RELEASE'
}

archivesBaseName = 'nvd'
version = '1.0.0-SNAPSHOT'

dependencies {
	implementation project(':nvd-lib')
	implementation 'info.picocli:picocli-spring-boot-starter:4.6.3'
	implementation 'com.diogonunes:JColor:5.5.1'
	implementation 'com.fasterxml.jackson.core:jackson-databind:2.13.4.2'
	implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.13.4'

	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

bootJar {
	launchScript()
}

application {
    mainClass = 'dev.jeremylong.nvd.cli.Application'
}

task generateAutocomplete(type: JavaExec) {
	mainClass = 'picocli.AutoComplete'
	classpath = sourceSets.main.runtimeClasspath
	args = [ '--force','--name', 'nvd', '--completionScript', "${buildDir}/nvd_completion.sh", 'dev.jeremylong.nvd.cli.commands.MainCommand' ]
}
assemble.dependsOn generateAutocomplete